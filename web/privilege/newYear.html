<!DOCTYPE html>
<html>
<head>
	<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0">
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	@@include('html-head.html')
	<title>优惠</title>
	<link rel="stylesheet" href="/style/css/swiper.min.css">
	<link rel="stylesheet" href="/style/layui/css/layui.css">
	<link rel="stylesheet" href="/style/css/index.css">
	<link rel="stylesheet" href="/style/css/youhui.css">
    <link rel="stylesheet" href="/style/css/newyear.css">
	<script src="/style/js/jquery-3.3.1.min.js"></script>
	<script type="text/javascript" src="/style/js/swiper.min.js"></script>
	<script src="/style/layui/layui.all.js"></script>
	<script src="/style/js/md5.js" type="text/javascript" ></script>
	<script src="/style/js/common.js" type="text/javascript" ></script>

	<style>
	</style>
</head>
<body style="background-color: #ffffff;">
@@include('header.html')
<div class="bannerBox swiper-container">
	<div class="swiper-wrapper">
		<div class="swiper-slide swiper-no-swiping"><img src="https://ezeu.ytyq8866.com/resources/web_h5/images/newyear/banner.png" class="man" style="cursor: pointer;"></div>
	</div>
</div>
@@include('right-side.html')
<div class="overlay"></div>
<div class="container">
    <div class="progressbar">
        <div class="layui-row">
            <div class="layui-col-xs2">
                我的存款:
            </div>
            <div class="layui-col-xs10">
                <div class="money">
                    <p class="zero">0</p>
                    <p class="one">3000</p>
                    <p class="two">8000</p>
                    <p class="three">20000</p>
                    <p class="four">50000</p>
                    <p class="five">100000</p>
                    <p class="six">300000</p>
                    <p class="seven">500000</p>
                    <p class="eight">1000000</p>
                </div>
                <div class="bar_grey"></div>
                <div class="bar_red"></div>
                <div class="arrow">
                    <img src="https://ezeu.ytyq8866.com/resources/web_h5/images/newyear/arrow.png">
                    <p>0</p>
                </div>
            </div>
        </div>
    </div>
    <div class="newyearpacket">
        <div class="text">
            <p>存款达到要求即可获得对应红包
                <br>
                <span>活动时间：2019年1月1-15日期间</span>
            </p>

        </div>
        <div class="layui-row">
            <div class="layui-col-xs3">
                <img src="https://ezeu.ytyq8866.com/resources/web_h5/images/newyear/yuan01.png">
                <div class="btn-newyear">
                    <button id="get_btn_0" class="layui-btn pop-up-btn">立即领取</button>
                </div>
            </div>
            <div class="layui-col-xs3">
                <img src="https://ezeu.ytyq8866.com/resources/web_h5/images/newyear/yuan02.png">
                <div class="btn-newyear">
                    <button id="get_btn_1" class="layui-btn pop-up-btn">立即领取</button>
                </div>
            </div>
            <div class="layui-col-xs3">
                <img src="https://ezeu.ytyq8866.com/resources/web_h5/images/newyear/yuan03.png">
                <div class="btn-newyear">
                    <button id="get_btn_2" class="layui-btn pop-up-btn">立即领取</button>
                </div>
            </div>
            <div class="layui-col-xs3">
                <img src="https://ezeu.ytyq8866.com/resources/web_h5/images/newyear/yuan04.png">
                <div class="btn-newyear">
                    <button id="get_btn_3" class="layui-btn pop-up-btn">立即领取</button>
                </div>
            </div>
            <div class="layui-col-xs3">
                <img src="https://ezeu.ytyq8866.com/resources/web_h5/images/newyear/yuan05.png">
                <div class="btn-newyear">
                    <button id="get_btn_4" class="layui-btn pop-up-btn">立即领取</button>
                </div>
            </div>
            <div class="layui-col-xs3">
                <img src="https://ezeu.ytyq8866.com/resources/web_h5/images/newyear/yuan06.png">
                <div class="btn-newyear">
                    <button id="get_btn_5"class="layui-btn pop-up-btn">立即领取</button>
                </div>
            </div>
            <div class="layui-col-xs3">
                <img src="https://ezeu.ytyq8866.com/resources/web_h5/images/newyear/yuan07.png">
                <div class="btn-newyear">
                    <button id="get_btn_6" class="layui-btn pop-up-btn">立即领取</button>
                </div>
            </div>
            <div class="layui-col-xs3">
                <img src="https://ezeu.ytyq8866.com/resources/web_h5/images/newyear/yuan08.png">
                <div class="btn-newyear">
                    <button id="get_btn_7" class="layui-btn pop-up-btn">立即领取</button>
                </div>
            </div>
        </div>
    </div>
    <div class="pop-up">
        <div class="layui-row">
            <img src="https://ezeu.ytyq8866.com/resources/web_h5/images/newyear/popup.png">
            <p>成功领取</p>
            <div class="btn-pop-up">
                <button class="layui-btn close-btn">确定</button>
            </div>
        </div>
    </div>
</div>
@@include('footer.html')
<div class="hideAll"></div>
</body>
@@include('html-foot.html')
<script>
	$(function () {
        if(wap_is_user_notexist()){
            window.location.href="/";
        }else{
            newYearInit();
        }
    });
    function newYearInit(){
        $.ajax({
            dataType: "jsonp",
            url:wap_site_host() + "/session/newYearPrivilege/init",
            type:"POST",
            data:{'token': wap_get_user().token},
            dataType: 'json',
            success:function(d){
                if (d.code == 0) {
                    changeProgressBar(d.amount);
                    changeApplyBtn(d.getInfo);
                } else {
                    fun_alertMsg(d.msg, function() {});
                    changeProgressBar(0);
                    changeApplyBtn(new Array(-1,-1,-1,-1,-1,-1,-1,-1));
                    wap_if_session_out(d.code);
                }
            },
            error:function(jqXHR, textStatus, errorThrown){
                wap_check_ajaxerror(jqXHR);
                fun_alertMsg('查询元旦红包异常！', function() {});
                changeProgressBar(0);
                changeApplyBtn(new Array(-1,-1,-1,-1,-1,-1,-1,-1));
            }
        });
    }
    function changeProgressBar(amount){
        //var bar_length=new Array(121,229,336,443,550,657,765,873);
        $('.arrow p').html(amount.toFixed(2));
        if($('.arrow').width()>$('.arrow img').width()){
            var p_left=$('.arrow').width()/2-$('.arrow img').width()/2;
            $('.arrow img').css('padding-left',p_left+'px');
        }
        changeColor(amount);
        if(amount==0){
            $('.bar_red').width(0);
            $('.arrow').css('left','-15px');
        }else if(amount>0 && amount<3000){
            var width=amount/3000*121;
            width=width>20?width:20;
            $('.bar_red').width(width);
            var left=width-5-($('.arrow').width()/2);
            $('.arrow').css('left',left+'px');
        }else if(amount>=3000 && amount<8000){
            var width=(amount-3000)/5000*108+121;
            $('.bar_red').width(width);
            var left=width-5-($('.arrow').width()/2);
            $('.arrow').css('left',left+'px');
        }else if(amount>=8000 && amount<20000){
            var width=(amount-8000)/12000*107+229;
            $('.bar_red').width(width);
            var left=0;
            var left=width-5-($('.arrow').width()/2);
            $('.arrow').css('left',left+'px');
        }else if(amount>=20000 && amount<50000){
            var width=(amount-20000)/30000*107+336;
            $('.bar_red').width(width);
            var left=width-5-($('.arrow').width()/2);
            $('.arrow').css('left',left+'px');
        }else if(amount>=50000 && amount<100000){
            var width=(amount-50000)/50000*107+443;
            $('.bar_red').width(width);
            var left=width-5-($('.arrow').width()/2);
            $('.arrow').css('left',left+'px');
        }else if(amount>=100000 && amount<500000){
            var width=(amount-100000)/400000*214+550;
            $('.bar_red').width(width);
            var left=width-5-($('.arrow').width()/2);
            $('.arrow').css('left',left+'px');
        } else if(amount>=500000 && amount<1000000){
            var width=(amount-500000)/500000*108+765;
            $('.bar_red').width(width);
            var left=width-5-($('.arrow').width()/2);
            $('.arrow').css('left',left+'px');
        } else if(amount>=1000000){
            $('.bar_red').width(873);
            $('.arrow').css('left','818px');
        }
    }
    function changeColor(amount) {
        if(amount>0){
            $('.zero').css('color','#c40000');
        }
        if(amount>3000){
            $('.one').css('color','#c40000');
        }
        if(amount>8000){
            $('.two').css('color','#c40000');
        }
        if(amount>20000){
            $('.three').css('color','#c40000');
        }
        if(amount>50000){
            $('.four').css('color','#c40000');
        }
        if(amount>100000){
            $('.five').css('color','#c40000');
        }
        if(amount>300000){
            $('.six').css('color','#c40000');
        }
        if(amount>500000){
            $('.seven').css('color','#c40000');
        }
        if(amount>1000000){
            $('.eight').css('color','#c40000');
        }
    }
    function changeApplyBtn(getInfo){
        for(var i=0;i<getInfo.length;i++){
            if(getInfo[i]==0){
                $('#get_btn_'+i).attr("onclick","applyBouns("+i+")");
            }else if(getInfo[i]>0){
                $('#get_btn_'+i).html('已领取');
                $('#get_btn_'+i).css('background-color','grey');
                $('#get_btn_'+i).css('color','white');
            }else if(getInfo[i]<0){
                $('#get_btn_'+i).attr("onclick","can_not_apply()");
            }
        }
    }
    function can_not_apply(){
        fun_alertMsg('您暂不符合存款要求，请您继续存款，符合后即可领取红包！', function() {});
    }
    function applyBouns(index){
        if(index>7 || index<0)
            return;
        $.ajax({
            dataType: "jsonp",
            url:wap_site_host() + "/session/newYearPrivilege/apply",
            type:"POST",
            data:{'token': wap_get_user().token,'index':index},
            dataType: 'json',
            success:function(d){
                if (d.code == 0) {
                    fun_alertMsg(d.msg, function() {
                        window.location.reload();
                    });
                } else {
                    fun_alertMsg(d.msg, function() {});
                    wap_if_session_out(d.code);
                }
            },
            error:function(jqXHR, textStatus, errorThrown){
                wap_check_ajaxerror(jqXHR);
                fun_alertMsg('领取元旦红包异常！', function() {});
            }
        });
    }
</script>
</html>
